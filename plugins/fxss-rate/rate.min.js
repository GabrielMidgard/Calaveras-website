!function(){var jsPath;$.fn.rateDefaults={version:"0.0.1",type:0,length:5,value:3.5,half:!0,decimal:!0,readonly:!0,hover:!1,text:!0,textList:["极差","差","中等","好","非常好"],theme:"#FFB800",size:"20px",gutter:"3px",selectClass:"rate_select",incompleteClass:"",customClass:"",validate:function(){var _this=this;1*this.value>1*this.length&&alert("value应小于等于length"),this.textList.length>1*this.length&&alert("textList.length应小于等于length")},getPath:(jsPath=document.currentScript?document.currentScript.src:function(){for(var js=document.scripts,last=js.length-1,src,i=last;i>0;i--)if("interactive"===js[i].readyState){src=js[i].src;break}return src||js[last].src}(),jsPath.substring(0,jsPath.lastIndexOf("/")+1)),link:function(href,cssname){if(this.getPath){var head=document.getElementsByTagName("head")[0],link=document.createElement("link"),id=cssname;link.rel="stylesheet",link.href=this.getPath+href,link.id=id,document.getElementById(id)||head.appendChild(link)}},script:function(src,jsname){if(this.getPath){var head=document.getElementsByTagName("head")[0],script=document.createElement("script"),id=jsname;script.src=this.getPath+src,script.id=id,document.getElementById(id)||head.appendChild(script)}},addEventClick:function(renderBox,type){var _this=this;$(renderBox).find(".rate_box").on("click",".rate_item",function(){var $this=$(this);if(_this.value==$this.index()+1)return!1;_this.value=$this.index()+1,_this.render(renderBox,type);var object={dom:$(renderBox)[0],index:$this.index()};_this.callback(object)})},countValue:function(){var _this=this,returnValue;return returnValue=this.value==parseInt(this.value)?{int:this.value,float:""}:{int:parseInt(this.value),float:(1e3*parseFloat(this.value)-1e3*parseInt(this.value))/1e3}},countText:function(){var _this=this,curFloat=this.value*this.textList.length/this.length,curRound=Math.round(curFloat),curIndex=0;return curIndex=curRound>0?curRound-1:curRound,(this.decimal||this.half)&&this.value>parseInt(this.value)&&this.value>(curRound?curRound*this.length/this.textList.length:this.length/this.textList.length)&&curIndex++,this.textList[curIndex]},getIconName:function(index,type){var rateItemIconUnicode;return 1*type==2?["&#xe610;","&#xe604;","&#xe608;","&#xe605;","&#xe606;","&#xe607;","&#xe60b;","&#xe60a;","&#xe60c;","&#xe60d;","&#xe609;"][index]:"icon-stars-"+index},render:function(renderBox,type){var _this=this,rateBoxHtml="",rateHtml="",rateHtmlTpl='<div class="rate_wrapper '+this.customClass+(this.hover?'" title="'+this.value+'"':'"')+'><div class="rate_box clearfix">{{rateHtmlTpl}}</div>{{textTpl}}</div>',rateItemIcon="",rateItemStyle=(this.theme?"color:"+this.theme:"")+";"+(this.gutter?"margin: 0 "+this.gutter:"")+";",rateItemIconStyle=(this.size?"font-size:"+this.size:"")+";";1*type==0?rateItemIcon='<svg class="icon" style="'+rateItemIconStyle+'" aria-hidden="true"><use xlink:href="#{{iconname}}"></use></svg>':1*type==1?rateItemIcon='<i class="iconfont {{iconname}}" style="'+rateItemIconStyle+'"></i>':1*type==2&&(rateItemIcon='<i class="iconfont icon-rate-item" style="'+rateItemIconStyle+'">{{iconname}}</i>');for(var rateItemTpl='<div class="rate_item {{selectClass}}" style="'+rateItemStyle+'">'+rateItemIcon+"</div>",valueObj=this.countValue(),i=0;i<this.length;i++)if(this.decimal||this.half)if(i<valueObj.int)rateHtml+=rateItemTpl.replace("{{selectClass}}",this.selectClass).replace("{{iconname}}",this.getIconName(10,type));else if(i==valueObj.int){var index=0;this.decimal?index=10*valueObj.float:this.half&&(index=valueObj.float<.33?0:valueObj.float>.66?10:5),rateHtml+=rateItemTpl.replace("{{selectClass}}",this.incompleteClass).replace("{{iconname}}",this.getIconName(index,type))}else rateHtml+=rateItemTpl.replace("{{selectClass}}","").replace("{{iconname}}",this.getIconName(0,type));else i<valueObj.int?rateHtml+=rateItemTpl.replace("{{selectClass}}",this.selectClass).replace("{{iconname}}",this.getIconName(10,type)):rateHtml+=rateItemTpl.replace("{{selectClass}}","").replace("{{iconname}}",this.getIconName(0,type));rateBoxHtml=rateHtmlTpl.replace("{{rateHtmlTpl}}",rateHtml);var textStyle=(this.theme?"color:"+this.theme:"")+";"+(this.size?"font-size:"+this.size:"")+";";rateBoxHtml=this.text&&this.value>0?rateBoxHtml.replace("{{textTpl}}",'<div class="rate_text" style="'+textStyle+'">'+this.countText()+"</div>"):rateBoxHtml.replace("{{textTpl}}",""),$(renderBox).html(rateBoxHtml),this.readonly||this.addEventClick(renderBox,type)},callback:function(object){}},$.fn.rate=function(option){var options=$.extend({},$.fn.rateDefaults,option);return options.link("rate.css","rateLink"),1*options.type==0?options.script("need/iconfont.js","rateIconfontSvg"):options.link("need/iconfont.css","rateIconfontCss"),this.each(function(index,element){options.validate(),options.render(element,options.type)}),this}}(jQuery);